version: '3'
services:
  grpc:
    build:
      context: ../..
      dockerfile: ./build/package/Dockerfile
    command: ./antibrutefroce --config ./configs/config.yaml grpc
    volumes: 
      - ../../configs:/root/configs
    ports:
      - 50051

  tests:
    build:
      context: ../..
      dockerfile: ./build/package/Dockerfile-tests
    # command: ./tests --config ./configs/config.yml --features-path ./features/
    environment:
      - GRPC_SERVER_HOST=grpc
      - GRPC_SERVER_PORT=50051
    volumes:
      - ../../configs:/root/configs
      - ../../test/integration/grpc/features:/root/features
    depends_on:
      - grpc